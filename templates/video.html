{% extends 'snippet/layout.html' %}

{% block javascript %}
<script type="text/javascript">
      $(document).ready(function(){

        $(document).on('click', '.create-channel',  function() {
          $(this).hide();
          $(".channel-box").show();
        });

        $(document).on('click', '.cancel-post',  function() {
          $(".channel-box").hide();
          $(".create-channel").show();
        });
      });
    </script>

<script type="text/javascript">
        jQuery(document).ready(function() {
            $('.follow').click(function() {
                var channel_id = $(this).find('input').val();    
                if($(this).hasClass('followed')) {
                        $.getJSON('/f/'+channel_id, function(data) {
                            if(data.success!=0&&data.message=="revert_followed") {
                                $('#btn-'+channel_id).removeClass('followed');
                                $('#btn-'+channel_id).find('span').text("关注");

                            }
                        });                        
                } else {
                    $.getJSON('/f/'+channel_id, function(data) {
                        if(data.success!=0&&data.message=="success_followed") {
                            $('#btn-'+channel_id).addClass('followed');
                            $('#btn-'+channel_id).find('span').text("取消关注");

                        }
                    }); 
                }
            });        
        });
    </script>
{% endblock %}

{% block main %}
<div class="channels">
  <div class="taglist-holder">
    <ul class="taglist clearfix">
      <li class="selected">
        <a href="http://www.diandian.com/category/%E8%89%BA%E6%9C%AF">所有</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E6%97%85%E8%A1%8C">旅行</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E6%91%84%E5%BD%B1">摄影</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E8%AE%BE%E8%AE%A1">设计</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E6%8F%92%E7%94%BB">插画</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E9%98%85%E8%AF%BB">阅读</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E9%9F%B3%E4%B9%90">音乐</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E5%BD%B1%E8%A7%86">影视</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E6%97%B6%E5%B0%9A">时尚</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E5%88%9B%E6%84%8F">创意</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E5%BB%BA%E7%AD%91">建筑</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E8%89%BA%E6%9C%AF%E5%AE%B6">艺术家</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E6%97%85%E8%A1%8C%E5%AE%B6">旅行家</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E6%91%84%E5%BD%B1%E5%B8%88">摄影师</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E8%AE%BE%E8%AE%A1%E5%B8%88">设计师</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E6%8F%92%E7%94%BB%E5%B8%88">插画师</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E4%BD%9C%E5%AE%B6">作家</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E7%94%B5%E5%8F%B0">电台</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E5%8A%A8%E6%BC%AB">动漫</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E5%AE%B6%E5%B1%85">家居</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E6%96%87%E5%8C%96">文化</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E6%80%AA%E8%B6%A3">怪趣</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E7%BE%8E%E9%A3%9F">美食</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E7%94%9F%E6%B4%BB">生活</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E6%B8%B8%E6%88%8F">游戏</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E6%81%8B%E7%89%A9">恋物</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E7%A7%91%E5%AD%A6">科学</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E8%BF%90%E5%8A%A8">运动</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E6%B1%BD%E8%BD%A6">汽车</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/IT">IT</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E5%AA%92%E4%BD%93">媒体</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E6%96%B0%E9%97%BB">新闻</a>
      </li>
      <li>
        <a href="http://www.diandian.com/category/%E6%B4%BB%E5%8A%A8">活动</a>
      </li>
    </ul>
    <div class="create-channel">
      <a href="javascript:void(0)" class="btn btn-primary">创建频道</a>
    </div>
  </div>

  <div class="channel-box" style="display:none">
    <form class="mt10" action="/video" method="post">
      <div class="row1">
        <div class="t-avatar">
          <a href="/u/{{ user_info.username }}">
            <img src="/static/avatar/user/m_{{ user_info.avatar or 'default.png' }}"></a>
        </div>
        <div class="v-description">
          <textarea rows="3" class="content mt5 smart-code-support J_replyContent" placeholder="写点频道介绍吧..." name="intro"></textarea>
        </div>
      </div>
      <div class="row2">
        <div class="t-link">频道名称:</div>
        <div class="v-link">
          <input type="text" placeholder="输入频道名称" name="name"></div>
      </div>
      <div class="row4">
        <span class="post-btn-wrap">
          <input role="button"  type="submit" id="61.post" class="gbtn post" value="创建频道">
          {{ xsrf_form_html() }}
          <div role="button" id=":61.cancel" class="gbtn cancel cancel-post" style="-webkit-user-select: none;">取消</div>
        </span>
      </div>
    </form>
  </div>
  {% for channel in channels.list %}
  <div class="KBylAf channel-card">
    <div class="cja Os3xkf Ltb">
      <div class="r6Rtbe vlMSze TjKfDe Eqy3Ue j8T7he" role="article">
        <div class="sNZZue l8zNY">
          <a href="/c/{{ channel.id }}" class="FW9qdb Wk gosnEc HF7jKf" aria-hidden="true" data-tileposition="5">
            <img src="/static/avatar/channel/b_{{ channel.avatar or 'default.png' }}?t={{ gen_random() }}" width="170px" height="170px" alt="" class="Rf " data-pinit="registered"></a>
        </div>
        <div class="JZc2Fe"></div>
        <div class="gecJce Xk6Ee">
          <a href="/c/{{ channel.id }}" class="fmPSLc Dt0N7d WBzBVe HF7jKf FW9qdb" data-tileposition="5">{{ channel.name }}</a>
          <div class="We4Wwc ljarXd">{{ channel.intro }}</div>
        </div>
        <div class="kOVcgc dS">
          <div class="Dq er a-f-e follow-toggle">
            
            {% if channel.follow_user_id %}
            {% if channel.follow_user_id==channel.author_id %}
            <div role="button" id="btn-{{ channel.id }}" class="a-f-e c-b c-b-T y-qa-za-b-s y-qa-za-b followed disabled" title="" style="visibility: visible; -webkit-user-select: none; max-width: 232px;">
              <input type="hidden" name="channel_id" value="{{ channel.id }}">
              <span class="follow-text" dir="ltr">已关注</span>
            </div>
            {% else %}
            <div role="button" id="btn-{{ channel.id }}" class="a-f-e c-b c-b-T y-qa-za-b-s y-qa-za-b follow followed" title="" style="visibility: visible; -webkit-user-select: none; max-width: 232px;">
              <input type="hidden" name="channel_id" value="{{ channel.id }}">
              <span class="follow-text" dir="ltr">取消关注</span>
            </div>
            {% endif %}
            {% else %}
            <div role="button" id="btn-{{ channel.id }}" class="a-f-e c-b c-b-T y-qa-za-b-s y-qa-za-b follow" title="" style="visibility: visible; -webkit-user-select: none; max-width: 232px;">
              <input type="hidden" name="channel_id" value="{{ channel.id }}">
              <span class="follow-text" dir="ltr">关注</span>
            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %}

{% block right %}
{% endblock %}